<html>

<head>
    <!-- Include Twitter Bootstrap and jQuery: -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css"/>
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <!-- <script type="text/javascript" src="js/bootstrap.min.js"></script>
    <script type="text/javascript" src="js/popper.min.js"></script>
    <script type="text/javascript" src="js/popper-utils.min.js"></script> -->
    <!-- Include the plugin's CSS and JS: -->
    <!-- <script type="text/javascript" src="js/bootstrap-multiselect.js"></script>
    <link rel="stylesheet" href="css/bootstrap-multiselect.css" type="text/css"/> -->
    <script src="js/chosen.jquery.min.js" type="text/javascript"></script>
    <link rel="stylesheet" type="text/css" href="css/chosen.min.css">
    <link rel="stylesheet" type="text/css" href="css/trainup.css">

    <!--Temporary comment for slow internet-->
    <!--<link href="https://fonts.googleapis.com/css?family=Rubik+Mono+One" rel="stylesheet"> -->
</head>

<body>
<!-- <form id="skills-form" action="/skills" method="post"> -->
    <h1>Skills</h1>
    <select id="skillWrapper"  multiple="multiple">
        <option class="skill">P&L Analysis</option>
        <option class="skill">Margin Optimization</option>
        <option class="skill">Data Analysis'</option>
        <option class="skill">Financial Modeling</option>
        <option class="skill">Presentation</option>
        <option class="skill">Project Management'</option>
        <option class="skill">Talent Management</option>
        <option class="skill">Team Development</option>
        <option class="skill">Risk Management'</option>
        <option class="skill">CapEx Strategy</option>
        <option class="skill">*Data Extraction</option>
        <option class="skill">*SQL</option>
        <option class="skill">*Python</option>
        <option class="skill">*HTML'</option>
        <option class="skill">Javascript</option>
        <option class="skill">Design Thinking</option>
        <option class="skill">*UX Design'</option>
        <option class="skill">*App Store Optimization</option>
        <option class="skill">*Product Marketing'</option>
        <option class="skill">Story / Issue Ticketing</option>
        <option class="skill">Analytics Software</option>
        <option class="skill">A/B Testing'</option>
        <option class="skill">Prototype Design</option>
        <option class="skill">Experiment Design</option>
        <option class="skill">Roadmapping'</option>
        <option class="skill">API Integration</option>
        <option class="skill">Team Management</option>
        <option class="skill">Strategy</option>
    </select>
    <div class="buttonWrapper" id="buttonWrapper">
      <button id="select" type="submit">Show Resources</button>
    </div>
  <!-- </form> -->
    <h1>Courses</h1>
    <ul id="list">
    </ul>
    <div class="courseWrapper">
    <div class="course">
        <div class="title">Build Responsive Real World Websites with HTML5 and CSS3</div>
        <div class="rating twostar"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 566.29 101.09"><defs><style>.cls-1{fill:#fff;}</style></defs><title>Artboard 1</title><g id="Star1"><polygon class="cls-1" points="513.14 0 529.57 33.28 566.29 38.61 539.72 64.51 545.99 101.09 513.14 83.82 480.3 101.09 486.57 64.51 460 38.61 496.72 33.28 513.14 0"/></g><g id="Star2"><polygon class="cls-1" points="398.14 0 414.57 33.28 451.29 38.61 424.72 64.51 430.99 101.09 398.14 83.82 365.3 101.09 371.57 64.51 345 38.61 381.72 33.28 398.14 0"/></g><g id="Star3"><polygon class="cls-1" points="283.14 0 299.57 33.28 336.29 38.61 309.72 64.51 315.99 101.09 283.14 83.82 250.3 101.09 256.57 64.51 230 38.61 266.72 33.28 283.14 0"/></g><g id="Star4"><polygon class="cls-1" points="168.15 0 184.57 33.28 221.29 38.61 194.72 64.51 200.99 101.09 168.15 83.82 135.3 101.09 141.57 64.51 115 38.61 151.72 33.28 168.15 0"/></g><g id="Star5"><polygon class="cls-1" points="53.15 0 69.57 33.28 106.29 38.61 79.72 64.51 85.99 101.09 53.15 83.82 20.3 101.09 26.57 64.51 0 38.61 36.72 33.28 53.15 0"/></g></svg></div>
    </div>
     <div class="course">
        <div class="title">Build Responsive Real World Websites with HTML5 and CSS3</div>
        <div class="rating threestar"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 566.29 101.09"><defs><style>.cls-1{fill:#fff;}</style></defs><title>Artboard 1</title><g id="Star1"><polygon class="cls-1" points="513.14 0 529.57 33.28 566.29 38.61 539.72 64.51 545.99 101.09 513.14 83.82 480.3 101.09 486.57 64.51 460 38.61 496.72 33.28 513.14 0"/></g><g id="Star2"><polygon class="cls-1" points="398.14 0 414.57 33.28 451.29 38.61 424.72 64.51 430.99 101.09 398.14 83.82 365.3 101.09 371.57 64.51 345 38.61 381.72 33.28 398.14 0"/></g><g id="Star3"><polygon class="cls-1" points="283.14 0 299.57 33.28 336.29 38.61 309.72 64.51 315.99 101.09 283.14 83.82 250.3 101.09 256.57 64.51 230 38.61 266.72 33.28 283.14 0"/></g><g id="Star4"><polygon class="cls-1" points="168.15 0 184.57 33.28 221.29 38.61 194.72 64.51 200.99 101.09 168.15 83.82 135.3 101.09 141.57 64.51 115 38.61 151.72 33.28 168.15 0"/></g><g id="Star5"><polygon class="cls-1" points="53.15 0 69.57 33.28 106.29 38.61 79.72 64.51 85.99 101.09 53.15 83.82 20.3 101.09 26.57 64.51 0 38.61 36.72 33.28 53.15 0"/></g></svg></div>
    </div>
    </div>
  <button id="next" type="submit">MVP</button>
</body>
</html>
<script type="text/javascript">
// onclick event is assigned to the #button element.
document.getElementById("next").onclick = function() {
  window.location.href = "/mvp";
};
// $(document).ready(function() {
//     $('#skillWrapper').multiselect();
// });
$("#skillWrapper").chosen();

var roleToSkills = <%-JSON.stringify(roleToSkills) %>
var skillToResources = <%-JSON.stringify(skillToResources) %>

// alert(skill_resources.skills[0].resources[0].name)
document.getElementById("buttonWrapper").onclick = function() {//skillToResources) {
  // window.location.href = "/level";
  // var selectedSkills = document.getElementById("skillWrapper");
  $("li").remove()
  // // Random crap
  // console.log(skills.options);
  // console.log(skills.selectedIndex);
  // var str_array = selectedUserRole.split(',');
  // console.log(str_array)
  // for (var i = 0; i < str_array.length; i++) {
  //     str_array[i] = str_array[i].replace(/^\s*/, "").replace(/\s*$/, "");
  // }
  // $("UserRole").val(str_array).trigger("chosen:updated");

  // 
  selectedSkills = $('#skillWrapper').chosen().val()
  // Get resources from selected skills
  // Hardcode to select Finance Director for now, need to GET/POST selection from previous screens
  var roleSkills = Array();
  for (var i = 0; i < roleToSkills.fields.length; i++) {
    var field = roleToSkills.fields[i].name
    console.log(field)
    if (field == 'Finance') {
      console.log('found finance')
      for (var j = 0; j < roleToSkills.fields[i].positions.length; j++) {
        var position = roleToSkills.fields[i].positions[j].name
        if (position == 'Director') {
          roleSkills = roleToSkills.fields[i].positions[j].skills;
          break;
        }
      }
      break;
    }
  }
  console.log(roleSkills);
  for (var i = 0; i < roleSkills.length; i++) {
    var bool = false;
    for (var si = 0; si < selectedSkills.length; si++){
      var resourceSkill = skillToResources.skills[i].name.replace( /[^a-zA-Z]/g, '' ).toLowerCase();
      var selectedSkill = selectedSkills[si].replace( /[^a-zA-Z]/g, '' ).toLowerCase();
      console.log(selectedSkill + ' = ' + resourceSkill + '?');
      if (selectedSkill == resourceSkill) {
        console.log('yes, found at ' + si);
        bool = true;
        break;
      }
    }
    console.log('bool: ' + bool)
    if (bool == true) {
      console.log('skipping skill: ' + skillToResources.skills[i])
      continue;
    }
    for (var j = 0; j < skillToResources.skills[i].resources.length; j++) {
      resource_name = skillToResources.skills[i].resources[j].name
      resource_link = skillToResources.skills[i].resources[j].link
      resource_node = resource_name.replace( /[^a-z]/g, '' );
      console.log(resource_name + ' found at skill index ' + si)
      createResource(resource_name, resource_node, resource_link)
    }
  }
};
function createResource(resourceName, resourceNode, resourceLink) {
  var ul = document.getElementById("list");
  var li = document.createElement("li");
  var a = document.createElement("a");

  var name = document.createTextNode(resource_name);
  var span = document.createElement('span');
  span.style.fontSize = "50px";
  span.style.color = "white";
  span.appendChild(name);
  a.appendChild(span);
  a.href = resourceLink;
  li.appendChild(a);
  li.setAttribute("id", resource_node);
  ul.appendChild(li);
}
</script>